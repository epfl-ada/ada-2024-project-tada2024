x window core protocol base protocol x window system , network window system bitmap display use build graphic user interfac unix , unix-lik , oper system . x window system base client-serv model : singl server control input/output hardwar , screen , keyboard , mous ; applic program act client , interact user client via server . interact regul x window core protocol . protocol relat x window system exist , built top x window core protocol separ protocol . x window core protocol , four kind packet sent , asynchron , network : request , repli , event , error . request sent client server ask perform oper ( exampl , creat new window ) send back data hold . repli sent server provid data . event sent server notifi client user activ occurr interest . error packet sent server notifi client error occur process request . request may gener repli , event , error ; , protocol mandat specif order packet sent network . extens core protocol exist , one request , repli , event , error . x window origin mit 1984 ( current releas x11 appear septemb 1987 ) . design bob scheifler jim getti set earli principl core protocol `` creat mechan , polici '' . result , core protocol specifi interact client client user . interact subject separ specif , icccm freedesktop.org specif , typic enforc automat use given widget set . # # overview commun server client done exchang packet channel . connect establish client . client also send first packet , contain byte order use inform version protocol kind authent client expect server use . server answer send back packet state accept refus connect , request authent . connect accept , accept packet contain data client use subsequ interact server . connect establish , four type packet exchang client server channel : request : client request inform server request perform action . repli : server respond request . request gener repli . event : server inform client event , keyboard mous input , window move , resiz expos , etc . error : server send error packet request invalid . sinc request queu , error packet gener request may sent immedi . request repli packet vari length , event error packet fix length 32 byte . request packet number sequenti server soon receiv : first request client number 1 , second 2 , etc . least signific 16 bit sequenti number request includ repli error packet gener request , . also includ event packet indic sequenti number request server current process finish process . # # window usual call window graphic user interfac call top-level window x window system . term window also use denot window lay within anoth window , , subwindow parent window . graphic element button , menu , icon , etc . realiz use subwindow . client request creation window . precis , request creation subwindow exist window . result , window creat client arrang tree ( hierarchi ) . root tree root window , special window creat automat server startup . window directli indirectli subwindow root window . top-level window direct subwindow root window . visibl , root window larg screen , lay behind window . content window alway guarante preserv time . particular , window content may destroy window move , resiz , cover window , gener made total partli non-vis . particular , content lost x server maintain back store window content . client request back store window maintain , oblig server . therefor , client assum back store maintain . visibl part window unspecifi content , event sent notifi client window content drawn . everi window associ set attribut , geometri window ( size posit ) , background imag , whether back store request , etc . protocol includ request client inspect chang attribut window . window inputoutput inputonli . window shown screen use draw first kind . second kind window never shown screen ; use receiv input . decor frame titl bar ( possibl includ button ) usual seen around window creat window manag , client creat window . window manag also handl input relat element , resiz window user click drag window frame . client usual oper window creat disregard chang oper window manag . chang take account re-par window manag , almost modern window manag , chang parent top-level window window root . point view core protocol , window manag client , differ applic . data window obtain run xwininfo program . pass -tree command-lin argument , program show tree subwindow window , along identifi geometri data . # # pixmap drawabl pixmap region memori use draw . contrari window , content pixmap automat shown screen . howev , content pixmap ( part ) transfer window vice versa . allow exampl implement doubl buffer . graphic oper done window also done pixmap . window pixmap collect name drawabl , content data resid server . client howev request content drawabl transfer server client vice versa . # # graphic context font client request number graphic oper , clear area , copi area anoth , draw point , line , rectangl , text . besid clear , oper possibl drawabl , window pixmap . request graphic oper includ graphic context , structur contain paramet graphic oper . graphic context includ foreground color , background colour , font text , graphic paramet . request graphic oper , client includ graphic context . clearli , paramet graphic context affect oper : exampl , font affect draw line . core protocol specifi use server-sid font . font store file , server access either directli via local filesystem via network anoth program call font server . client request list font avail server request font load ( alreadi ) unload ( use client ) server . client request gener inform font ( exampl , font ascent ) space specif string take drawn specif font . name font arbitrari string level x window core protocol . x logic font descript convent specifi font name accord attribut . convent also specifi valu option properti attach font . xlsfont program print list font store server . xfontsel program show glyph font , allow user select name font past anoth window . use server-sid font current consid deprec favour client-sid font font render client , server , support xft2 cairo librari xrender extens . specif client-sid font given core protocol . # # event event packet sent server client commun someth client may interest happen . exampl , event sent user press key click mous button . event use input : exampl , event sent indic creation new subwindow given window . everi event rel window . exampl , user click pointer window , event rel window . event packet contain identifi window . client request server send event anoth client ; use commun client . event exampl gener client request text current select : event sent client current handl window hold select . expos event sent area window destroy content made visibl . content window may destroy condit , exampl , window cover server maintain back store . server gener expos event notifi client part window drawn . kind event sent client previous state interest . client may interest kind event . exampl , client may interest keyboard-rel event mouse-rel event . kind event howev sent client even specif request . client specifi kind event want sent set attribut window . exampl , order redraw window content destroy , client must receiv expos event , inform window need drawn . client howev sent expos event client previous state interest event , done appropri set event mask attribut window . differ client request event window . even set differ event mask window . exampl , client may request keyboard event window anoth client request mous event window . possibl server , window , maintain separ event mask client . howev , kind event select one client time window . particular , event report mous button click chang relat window manag . xev program show event rel window . particular , xev -id wid request possibl event rel window identifi wid print . # # exampl follow possibl exampl interact server program creat window black box exit keypress . exampl , server send repli client request gener repli . request could gener error . client open connect server send initi packet specifi byte order use . server accept connect ( author involv exampl ) send appropri packet , contain inform identifi root window ( e.g. , 0x0000002b ) identifi client creat . client request creation default graphic context identifi 0x00200000 ( request , like request exampl , gener repli server ) client request server creat top-level window ( , specifi parent root window 0x0000002b ) identifi 0x00200001 , size 200x200 , posit ( 10,10 ) , etc . client request chang attribut window 0x00200001 , specifi interest receiv expos keypress event . client request window 0x00200001 map ( shown screen ) window made visibl content drawn , server send client expos event respons event , client request box drawn send polyfillrectangl request window 0x00200001 graphic context 0x00200000 window cover anoth window uncov , assum back store maintain : server send anoth expos event tell client window drawn client redraw window send polyfillrectangl request key press : server send keypress event client notifi user press key client react appropri ( case , termin ) # # color protocol level , colour repres 32-bit unsign integ , call pixelvalu . follow element affect represent color : colour depth colormap , tabl contain red , green , blue intens valu visual type , specifi tabl use repres color easiest case , colormap tabl contain rgb tripl row . pixelvalu x repres colour contain x -th row tabl . client chang entri colormap , represent identifi pseudocolor visual class . visual class staticcolor similar , client chang entri colormap . total six possibl visual class , one identifi differ way repres rgb tripl pixelvalu . pseudocolor staticcolor two . grayscal staticgray two , differ shade gray use . two remain visual class differ one break pixelvalu three part use three separ tabl red , green , blue intens . accord colour represent , pixelvalu convert rgb tripl follow : pixelvalu seen sequenc bit sequenc broken three part three chunk bit seen integ use index find valu three separ tabl mechan requir colormap compos three separ tabl , one primari colour . result convers still tripl intens valu . visual class use represent directcolor truecolor one , differ whether client chang colormap . six mechan repres color pixelvalu requir addit paramet work . paramet collect visual type , contain visual class paramet represent color . server fix set visualtyp , one associ numer identifi . identifi 32-bit unsign integ , necessarili differ identifi resourc atom . connect client accept , accept packet sent server contain sequenc block , one contain inform singl screen . screen , rel block contain list block , one rel specif colour depth support screen . support depth , list contain list visualtyp . result , screen associ number possibl depth , depth screen associ number possibl visual type . given visual type use screen differ depth . visual type , accept packet contain identifi actual paramet contain ( visual class , etc . ) client store inform , request afterward . moreov , client chang creat new visual type . request creation new window includ depth identifi visual type use repres color window . colormap use regardless whether hardwar control screen ( e.g. , graphic card ) us palett , tabl also use repres color . server use colormap even hardwar use palett . whenev hardwar us palett , limit number colormap instal . particular , colormap instal hardwar show color accord . client request server instal colormap . howev , may requir uninstal anoth colormap : effect window use uninstal colormap shown correct colour , effect dub colour flash technicolor . problem solv use standard colormap , colormap predict associ pixelvalu color . thank properti , standard colormap use differ applic . creation colormap regul icccm convent . standard colormap regul icccm xlib specif . # # atom atom 32-bit integ repres string . protocol design introduc atom repres string short fix size : string may arbitrarili long , atom alway 32-bit integ . atom short exploit mandat use kind packet like sent mani time string ; result effici use network . atom fix size exploit specifi fix size event , name 32 byte : fixed-s packet contain atom , contain long string . precis , atom identifi string store server . similar identifi resourc ( window , pixmap , etc . ) differ two way . first , identifi atom chosen server , client . word , client request creation new atom , send server string store , identifi ; identifi chosen server sent back repli client . second import differ resourc atom atom associ client . creat , atom surviv server quit reset ( default behaviour resourc ) . atom identifi therefor uniqu . howev , atom resourc identifi coincid . string associ atom call atom name . name atom chang creation , two atom name . result , name atom commonli use indic atom : “ atom abcd ” mean , precis , “ atom whose associ string abcd . ” “ atom whose name abcd . ” client request creation new atom request atom ( identifi ) given string . atom predefin ( creat server given identifi string ) . atom use number purpos , mostli relat commun differ client connect server . particular , use associ properti window , describ . list atom resid server print use program xlsatom . particular , program print atom ( identifi , , number ) name ( associ string ) . # # properti everi window predefin set attribut set properti , store server access client via appropri request . attribut data window , size , posit , background colour , etc . properti arbitrari piec data attach window . contrari attribut , properti mean level x window core protocol . client store arbitrari data properti window . properti character name , type , valu . properti similar variabl imper program languag , client creat new properti given name type store valu . properti associ window : two properti name exist two differ window differ type valu . name , type , valu properti string ; precis , atom , , string store server access client via identifi . client applic access given properti use identifi atom contain name properti . properti mostli use inter-cli commun . exampl , properti name wm_name ( properti name atom whose associ string `` wm_name '' ) use store name window . window manag typic read properti display name window titl bar . type inter-cli commun use properti root window . exampl , accord freedesktop window manag specif , window manag store identifi current activ window properti name _net_active_window root window . x resourc , contain paramet program , also store properti root window ; way , client access , even run differ comput . xprop program print properti given window ; xprop -root print name , type , valu properti root window . # # map x window system , everi individu , physic key associ number rang 8-255 , call keycod . keycod identifi key , particular charact term ( e.g. , `` page '' ) among one may print key . one charact term instead identifi keysym . keycod depend actual key press , keysym may depend , exampl , whether shift key anoth modifi also press . key press releas , server send event type keypress keyreleas appropri client . event contain : keycod press key current state modifi ( shift , control , etc . ) mous button server therefor send keycod modifi state without attempt translat specif charact . respons client convers . exampl , client may receiv event state given key press shift modifi . key would normal gener charact `` '' , client ( server ) associ event charact `` '' . translat keycod keysysm done client , tabl repres associ maintain server . store tabl central place make access client . typic client request map use decod keycod modifi field key event keysym . howev , client also chang map . modifi key , press , chang interpret key . common modifi shift key : key normal produc lowercas `` '' press togeth shift , produc uppercas `` '' . common modifi `` control '' , `` alt '' , `` meta '' . x server work eight modifi . howev , modifi associ one key . necessari mani keyboard duplic key modifi . exampl , mani keyboard two `` shift '' key ( one left one right ) . two key produc two differ keycod press , x server associ `` shift '' modifi . eight modifi , x server maintain list keycod consid modifi . exampl , list first modifi ( `` shift '' modifi ) contain keycod 0x37 , key produc keycod 0x37 consid shift key x server . list modifi map maintain x server chang everi client . exampl , client request `` f1 key '' ad list `` shift '' modifi . point , key behav like anoth shift modifi . howev , keycod correspond f1 still gener key press . result , f1 oper ( exampl , help window may open press ) , also oper like shift key ( press `` '' text editor f1 add `` '' current text ) . x server maintain us modifi map mous button . howev , button permut . mostli use exchang leftmost rightmost button left-hand user . xmodmap program show chang key , modifi , mous button map . # # grab grab condit keyboard mous event sent singl client . client request grab keyboard , mous , : request fulfil server , keyboard/mous event sent grab client grab releas . client receiv event . request grab , client specifi grab window : event sent grab client rel grab window . howev , client receiv event even select grab window . two kind grab : activ grab take place immedi passiv grab take place previous specifi key mous button press termin releas client estabilish grab keyboard , pointer , . request grab includ request freez keyboard pointer . differ grab freez grab chang recipi event , freez stop deliveri altogeth . devic frozen , event gener store queue deliv usual freez . pointer event , addit paramet affect deliveri event : event mask , specifi type event deliv one discard . request grab includ field specifi happen event would sent grab client even establish grab . particular , client request sent usual accord grab . two condit may appear . exampl , client would normal receiv keyboard event first window may request keyboard grab second window . event would normal sent first window may may redirect grab window depend paramet grab request . client also request grab entir server . case , request process server except one come grab client . # # request event core protocol exist . first kind request rel parent relationship window : client request chang parent window , request inform parenthood window . request rel select , howev mostli govern protocol . request input focu shape cursor . client also request owner resourc ( window , pixmap , etc . ) kill , caus server termin connect . final , client send no-oper request server . # # extens x window core protocol design extens . core protocol specifi mechan queri avail extens extens request , event , error packet made . particular , client request list avail extens data rel specif extens . packet extens similar packet core protocol . core protocol specifi request , event , error packet contain integ indic type ( exampl , request creat new window number 1 ) . rang integ reserv extens . # # author client initi establish connect server , server repli either accept connect , refus , request authent . authent request contain name authent method use . core protocol specifi authent process , depend kind authent use , end server either send accept refus packet . regular interact client server , request relat authent host-bas access method . particular , client request method enabl request read chang list host ( client ) author connect . typic applic use request ; use xhost program give user script access host access list . host-bas access method consid insecur . # # xlib client librari client program commun server via xlib client librari . particular , client use librari xaw , motif , gtk+ , qt turn use xlib interact server . use xlib follow effect : xlib make client synchron respect repli event : xlib function send request block appropri repli , expect , receiv ; word , x window client use xlib send request server oper wait repli , client use xlib call xlib function send request wait repli , thu block client wait repli ( unless client start new thread call function ) ; server send event asynchron , xlib store event receiv client queue ; client program access explicitli call function x11 librari ; word , client forc block busy-wait expect event . xlib send request server immedi , store queue , call output buffer ; request output buffer actual sent : program explicit request call librari function xflush ; program call function give result someth involv repli server , xgetwindowattribut ; program ask event event queue ( exampl , call xnextev ) call block ( exampl , xnextev block queue empti . ) higher-level librari xt ( turn use xaw motif ) allow client program specifi callback function associ event ; librari take care poll event queue call appropri function requir ; event indic need redraw window handl intern xt . lower-level librari , xcb , provid asynchron access protocol , allow better latenc hide . # # x window core protocol specifi x window core protocol mandat inter-cli commun specifi window use form visual element common graphic user interfac ( button , menu , etc . ) graphic user interfac element defin client librari realiz widget toolkit . inter-cli commun cover standard icccm freedesktop specif . inter-cli commun relev select , cut buffer , drag-and-drop , method use user transfer data window anoth . sinc window may control differ program , protocol exchang data necessari . inter-cli commun also relev x window manag , program control appear window gener look-and-feel graphic user interfac . yet anoth issu inter-cli commun extent relev session manag . user session start anoth issu cover core protocol . usual , done automat x display manag . user howev also start session manual run xinit startx program .